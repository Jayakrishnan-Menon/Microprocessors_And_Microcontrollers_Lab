;LCD interrupting
;INTERRUPT LED
ORG 0000H
	SJMP 0030H
ORG 0030H
	;MOV P3, #0FFH
	MOV IE, #10000100B
	SETB TCON.2
	MOV A, #38H ; 8 bit mode
	ACALL CMD
	ACALL DLAY
	MOV A, #0EH ; display on curson on
	ACALL CMD
	ACALL DLAY
	MOV A, #01H ; clear LCD
	ACALL CMD
	ACALL DLAY
Ag:	MOV A, #080H ;1st line
	ACALL CMD
	ACALL DLAY
	MOV DPTR,#M1
	ACALL RTLCD
	ACALL DLAY
	MOV A, #0C0H ;2nd line
	ACALL CMD
	ACALL DLAY
	MOV DPTR,#M1
	ACALL RTLCD
	ACALL DLAY
	ACALL DLAY
	SJMP Ag


;Command Subroutine
CMD: CLR P3.7
	 CLR P3.6
	 SETB P3.5
	 MOV P2, A
	 ACALL DLAY
	 CLR P3.5
	 RET
;Data Subroutine
DAT: SETB P3.7
	 CLR P3.6
	 SETB P3.5
	 ;SUBB A,#40H
	 MOV P2, A
	 ACALL DLAY
	 CLR P3.5
	 RET
;Delay Subroutine
DLAY: ;MOV R7, #0FH
Back: MOV R6, #01H
Here: DJNZ R6, Here
	  DJNZ R7, Back
	  RET
;Return to LCD Initial Subroutine
RTLCD:NOP
L1: CLR A
	MOVC A,@A+DPTR
	JZ OVER
	;ADD A,#40H
	ACALL DAT
	ACALL DLAY
	INC DPTR
	SJMP L1
OVER:RET

M1:DB '  NO INTERRUPT  ',0
M2:DB '    INTERRUPT   ',0
M3:DB '    OCCURED     ',0

ORG 0013H
LJMP 0200H
ORG 0200H
    MOV A, #080H ;1st line
	LCALL CMD
	LCALL DLAY
	MOV DPTR,#M2
	LCALL RTLCD
	LCALL DLAY
	MOV A, #0C0H ;2nd line
	LCALL CMD
	LCALL DLAY
	MOV DPTR,#M3
	LCALL RTLCD
	LCALL DLAY
RETI

END
